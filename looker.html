 dimension: ays_metrics {
    case: {
      when: {
        sql: (${assign_ays_submission_minute} - ${open_ays_timestamp_minute}) < 5 ;;
        label: "Ack < 5"
      }
      when: {
        sql: (${assign_ays_submission_minute} - ${open_ays_timestamp_minute}) > 5 ;;
        label: "Ack > 5"
      }
      when: {
        sql: (${close_ays_submission_minute} -${open_ays_timestamp_minute}) > 20 ;;
        label: "Close > 20"
      }
      else: "unknown"
    }
  }



The PostgreSQL 9.5+ database encountered an error while running this query.
ERROR: operator does not exist: text - text Hint: No operator matches the given name and argument types. You might need to add explicit type casts.


dimension: ays_metrics {
  case: {
    when: {
      sql: (EXTRACT(EPOCH FROM TIMESTAMP ${assign_ays_submission_minute}) - EXTRACT(EPOCH FROM TIMESTAMP ${open_ays_timestamp_minute})) / 60 < 5 ;;
      label: "Ack < 5"
    }
    when: {
      sql: (EXTRACT(EPOCH FROM TIMESTAMP ${assign_ays_submission_minute}) - EXTRACT(EPOCH FROM TIMESTAMP ${open_ays_timestamp_minute})) / 60 > 5 ;;
      label: "Ack > 5"
    }
    when: {
      sql: (EXTRACT(EPOCH FROM TIMESTAMP ${close_ays_submission_minute}) - EXTRACT(EPOCH FROM TIMESTAMP ${open_ays_timestamp_minute})) / 60 > 20 ;;
      label: "Close > 20"
    }
    else: "unknown"
  }
}
